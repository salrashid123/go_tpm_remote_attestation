go run src/grpc_attestor.go \
 --grpcport :50051 \
   --unsealPcrs=0,7  --caCertTLS certs/CA_crt.pem \
    --servercert certs/attestor_crt.pem \
     --serverkey certs/attestor_key.pem \
       -useFullAttestation=true --readEventLog=true  \
        --platformCertFile certs/platform_cert.der   --v=20 -alsologtostderr

I0613 19:02:26.453461    9007 grpc_attestor.go:1380] Starting gRPC server on port :50051
I0613 19:02:35.125775    9007 grpc_attestor.go:135] >> inbound request
I0613 19:02:35.125805    9007 grpc_attestor.go:158] HealthCheck called for Service [verifier.VerifierServer]
I0613 19:02:35.127442    9007 grpc_attestor.go:135] >> inbound request
I0613 19:02:35.127466    9007 grpc_attestor.go:172] ======= GetPlatformCert ========
I0613 19:02:35.127474    9007 grpc_attestor.go:173]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I0613 19:02:35.127553    9007 grpc_attestor.go:191]      Returning GetPlatformCert ========
I0613 19:02:35.129199    9007 grpc_attestor.go:135] >> inbound request
I0613 19:02:35.129220    9007 grpc_attestor.go:303] ======= GetEKCert ========
I0613 19:02:35.129227    9007 grpc_attestor.go:304]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I0613 19:02:35.129289    9007 grpc_attestor.go:310] =============== Load EncryptionKey and Certifcate from NV ===============
I0613 19:02:35.144737    9007 grpc_attestor.go:329]      Encryption PEM 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyLLB37zQTi3KfKridPpY
tj9yKm0ci/QUGqrzBsVVqxqOsQUxocsaKMZPIO7VxJlJd8KHWMoGY6f1VOdNUFCN
ufg5WMqA/t6rXvjF4NtPTvR05dCV4JegBBDnOjF9NgmV67+NgAm3afq/Z1qvJ336
WUop2prbTWpseNtdlp2+4TOBSsNZgsum3CFr40qIsa2rb9xFDrqoMTVkgKGpJk+z
ta+pcxGXYFJfU9sb7F7cs3e+TzjucGFcpVEiFzVq6Mga8cmh32sufM/PuifVYSLi
BYV4s4c53gVq7v0Oda9LqaxT2A9EmKopcWUU8CEgbsBxhmVAhsnKwLDmJYKULkAk
uwIDAQAB
-----END PUBLIC KEY-----
E0613 19:02:35.151065    9007 grpc_attestor.go:348] ERROR:   could not get NVReadEx: decoding NV_ReadPublic response: handle 1, error code 0xb : the handle is not correct for the use
I0613 19:02:35.155336    9007 grpc_attestor.go:135] >> inbound request
I0613 19:02:35.155362    9007 grpc_attestor.go:369] ======= GetAK ========
I0613 19:02:35.155369    9007 grpc_attestor.go:370]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I0613 19:02:35.157190    9007 grpc_attestor.go:378]      PCR [0] Value d0c70a9310cd0b55767084333022ce53f42befbb69c059ee6c0a32766f160783 
I0613 19:02:35.159074    9007 grpc_attestor.go:378]      PCR [7] Value 3d91599581f7a3a3a1bb7c7a55a7b8a50967be6506a5f47a9e89fef756fab07a 
I0613 19:02:35.159102    9007 grpc_attestor.go:384]      createPrimary
I0613 19:02:35.313315    9007 grpc_attestor.go:408]      tpmEkPub: 
&{25335809513149643389496549583789819547166935626485693688060367632236662508286611523312112435713086919354272819064305862763097734977571904602462837329823369102117886393952552996241196960603981790515850071903236829057907202532964451260607551400862400881025706604288115479743854907440442239953628450193259956637962522803053901876096146592491578056921842549428189611067098301324057528563692336339917028707174549291616421348483615100171399332267553957108609182196422514199175891347535706373927500615229925078316607770144273165593380298683795506228658017714363284890114528159326907374375876501618289613631706531407801099451 65537}
I0613 19:02:35.313499    9007 grpc_attestor.go:421]      ekPub Name: 000bb6fee5b86dee8a19c914e3ce2bf6a0877802c8c30134346585713a01d7da551f
I0613 19:02:35.313514    9007 grpc_attestor.go:422]      ekPubPEM: 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyLLB37zQTi3KfKridPpY
tj9yKm0ci/QUGqrzBsVVqxqOsQUxocsaKMZPIO7VxJlJd8KHWMoGY6f1VOdNUFCN
ufg5WMqA/t6rXvjF4NtPTvR05dCV4JegBBDnOjF9NgmV67+NgAm3afq/Z1qvJ336
WUop2prbTWpseNtdlp2+4TOBSsNZgsum3CFr40qIsa2rb9xFDrqoMTVkgKGpJk+z
ta+pcxGXYFJfU9sb7F7cs3e+TzjucGFcpVEiFzVq6Mga8cmh32sufM/PuifVYSLi
BYV4s4c53gVq7v0Oda9LqaxT2A9EmKopcWUU8CEgbsBxhmVAhsnKwLDmJYKULkAk
uwIDAQAB
-----END PUBLIC KEY-----
I0613 19:02:35.313532    9007 grpc_attestor.go:428]      tpmEkPub: 
&{25335809513149643389496549583789819547166935626485693688060367632236662508286611523312112435713086919354272819064305862763097734977571904602462837329823369102117886393952552996241196960603981790515850071903236829057907202532964451260607551400862400881025706604288115479743854907440442239953628450193259956637962522803053901876096146592491578056921842549428189611067098301324057528563692336339917028707174549291616421348483615100171399332267553957108609182196422514199175891347535706373927500615229925078316607770144273165593380298683795506228658017714363284890114528159326907374375876501618289613631706531407801099451 65537}
I0613 19:02:35.313596    9007 grpc_attestor.go:436]      CreateKeyUsingAuth
I0613 19:02:35.550615    9007 grpc_attestor.go:474]      akPub: 0001000b00050072000000100014000b0800000000000100c0f103ec8d3235f0203aa10fe1c1c27f699cf6d66f7f5340a413d87cb9cfe92369f6c80034179192cb0318ed431dce28e759c1492448e85bf106b17316167a8afb25b5eb8d15aa9299f145b761f249884addd48c67f12efbf2aff3610527afc1a48b83097387efb8a71d7b93072f2a71e19f9a5e5243845e29baa0cc5c5f3c521fdc6d1404f408208a2da54acca69bfac2752682e8127e21cf6d0cec08d4762b4d53c6ec8c9cff12231f8213092825b409fc8ac34e99c768805046261e54e1fcf05fddf452bb6c026ea7b543a7952e8cde97d9af43c157953b22064a3764434a6d37a088635a1842f488a42530c8dd4369d1e361cd354f6d7c8752d7a1c50f9b,
I0613 19:02:35.550673    9007 grpc_attestor.go:475]      akPriv: 0020056f633731ffee73091519bc27dfe1144dd3b302031d83f33094a8cdc4fdfc9900109049f4c4f8cf3c2182490d2bd7a58677c797d5229d9f2eeb180c75633ea7c73dfdbb32219fc0ff6ff6c459a1abdbc28538007f4cdf91d3719548d24a37f99db912542cc64ea0592730e3afa2e35e0a2059faa577bf659e6309888532cba698315b5b3b7fc52224480af618af022a976c99e0760d9d6fd5859470e4cfaeaa8eda1e5c40e161ded999a4c3e8ea425ef755a96bf00223c2781146db3cdb7058d5a342b86eed0922140d837179de2141bd5d6a939d51ae27bee28a58,
I0613 19:02:35.550720    9007 grpc_attestor.go:483]      CredentialData.ParentName.Digest.Value b6fee5b86dee8a19c914e3ce2bf6a0877802c8c30134346585713a01d7da551f
I0613 19:02:35.550740    9007 grpc_attestor.go:484]      CredentialTicket a093e4d3816c77ccf5dd82ae4debefe3fbbd4c8ec507a6c35e9d13f905b05918
I0613 19:02:35.550760    9007 grpc_attestor.go:485]      CredentialHash f5fc7775740d721412d90940618975350177c15513c3c4cc5dcf3d2be1329d84
I0613 19:02:35.550776    9007 grpc_attestor.go:487]      ContextSave (ek)
I0613 19:02:35.561531    9007 grpc_attestor.go:500]      ContextLoad (ek)
I0613 19:02:35.570677    9007 grpc_attestor.go:513]      LoadUsingAuth
I0613 19:02:35.580450    9007 grpc_attestor.go:550]      AK keyName 0022000bf7d196314b28e2a5ea67b70349edbfbbf8f32c12d16a54adc604afdb492a91dc
I0613 19:02:35.583501    9007 grpc_attestor.go:575]      akPubPEM: 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwPED7I0yNfAgOqEP4cHC
f2mc9tZvf1NApBPYfLnP6SNp9sgANBeRkssDGO1DHc4o51nBSSRI6FvxBrFzFhZ6
ivslteuNFaqSmfFFt2HySYhK3dSMZ/Eu+/Kv82EFJ6/BpIuDCXOH77inHXuTBy8q
ceGfml5SQ4ReKbqgzFxfPFIf3G0UBPQIIIotpUrMppv6wnUmgugSfiHPbQzsCNR2
K01TxuyMnP8SIx+CEwkoJbQJ/IrDTpnHaIBQRiYeVOH88F/d9FK7bAJup7VDp5Uu
jN6X2a9DwVeVOyIGSjdkQ0ptN6CIY1oYQvSIpCUwyN1DadHjYc01T218h1LXocUP
mwIDAQAB
-----END PUBLIC KEY-----
I0613 19:02:35.583556    9007 grpc_attestor.go:577]      Write (akPub) ========
I0613 19:02:35.583772    9007 grpc_attestor.go:583]      Write (akPriv) ========
I0613 19:02:35.583897    9007 grpc_attestor.go:595]      Returning GetAK ========
I0613 19:02:35.603799    9007 grpc_attestor.go:135] >> inbound request
I0613 19:02:35.603828    9007 grpc_attestor.go:607] ======= ActivateCredential ========
I0613 19:02:35.603835    9007 grpc_attestor.go:608]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I0613 19:02:35.603846    9007 grpc_attestor.go:610]      ContextLoad (ek)
I0613 19:02:35.612659    9007 grpc_attestor.go:623]      Read (akPub)
I0613 19:02:35.612755    9007 grpc_attestor.go:629]      Read (akPriv)
I0613 19:02:35.621534    9007 grpc_attestor.go:671]      keyName 0022000bf7d196314b28e2a5ea67b70349edbfbbf8f32c12d16a54adc604afdb492a91dc
I0613 19:02:35.621572    9007 grpc_attestor.go:673]      ActivateCredentialUsingAuth
I0613 19:02:35.635506    9007 grpc_attestor.go:726]      <--  activateCredential()
I0613 19:02:35.643861    9007 grpc_attestor.go:135] >> inbound request
I0613 19:02:35.643891    9007 grpc_attestor.go:199] ======= Attest ========
I0613 19:02:35.643897    9007 grpc_attestor.go:200]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I0613 19:02:35.643911    9007 grpc_attestor.go:207]      ContextLoad (ek) ========
I0613 19:02:35.651866    9007 grpc_attestor.go:219]      LoadUsingAuth ========
I0613 19:02:35.655247    9007 grpc_attestor.go:243]      Read (akPub) ========
I0613 19:02:35.655329    9007 grpc_attestor.go:249]      Read (akPriv) ========
I0613 19:02:35.659915    9007 grpc_attestor.go:263]      AK keyName 0022000bf7d196314b28e2a5ea67b70349edbfbbf8f32c12d16a54adc604afdb492a91dc
I0613 19:02:35.663984    9007 grpc_attestor.go:270]      AK CachedKey Name f7d196314b28e2a5ea67b70349edbfbbf8f32c12d16a54adc604afdb492a91dc
I0613 19:02:35.664022    9007 grpc_attestor.go:274]      Getting EventLog from /sys/kernel/security/tpm0/binary_bios_measurements
I0613 19:02:35.716057    9007 grpc_attestor.go:295]      Returning Attest ========
I0613 19:02:35.740752    9007 grpc_attestor.go:135] >> inbound request
I0613 19:02:35.740855    9007 grpc_attestor.go:839] ======= PushSecret ========
I0613 19:02:35.740866    9007 grpc_attestor.go:840]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I0613 19:02:35.740874    9007 grpc_attestor.go:843]      Loading EndorsementKeyRSA
I0613 19:02:35.749625    9007 grpc_attestor.go:860]      Importing External Key
I0613 19:02:35.768936    9007 grpc_attestor.go:866]      <-- End importKey()
I0613 19:02:35.768982    9007 grpc_attestor.go:870]      Hash of imported Key bZeQ9G0KuKpHVwfZuobcMf7tL/ViU1maVaJCAY+QjfU=
I0613 19:02:35.774630    9007 grpc_attestor.go:135] >> inbound request
I0613 19:02:35.774659    9007 grpc_attestor.go:959] ======= PullRSAKey ========
I0613 19:02:35.774669    9007 grpc_attestor.go:960]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I0613 19:02:35.774677    9007 grpc_attestor.go:962] ======= Generate UnrestrictedKey ========
I0613 19:02:35.774682    9007 grpc_attestor.go:964]      ContextLoad (ek) ========
I0613 19:02:35.783613    9007 grpc_attestor.go:977]      Loading AttestationKey
I0613 19:02:35.790488    9007 grpc_attestor.go:1018]      AK keyName: ACIAC/fRljFLKOKl6me3A0ntv7v48ywS0WpUrcYEr9tJKpHc,
I0613 19:02:35.792032    9007 grpc_attestor.go:1045]      akPub PEM 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwPED7I0yNfAgOqEP4cHC
f2mc9tZvf1NApBPYfLnP6SNp9sgANBeRkssDGO1DHc4o51nBSSRI6FvxBrFzFhZ6
ivslteuNFaqSmfFFt2HySYhK3dSMZ/Eu+/Kv82EFJ6/BpIuDCXOH77inHXuTBy8q
ceGfml5SQ4ReKbqgzFxfPFIf3G0UBPQIIIotpUrMppv6wnUmgugSfiHPbQzsCNR2
K01TxuyMnP8SIx+CEwkoJbQJ/IrDTpnHaIBQRiYeVOH88F/d9FK7bAJup7VDp5Uu
jN6X2a9DwVeVOyIGSjdkQ0ptN6CIY1oYQvSIpCUwyN1DadHjYc01T218h1LXocUP
mwIDAQAB
-----END PUBLIC KEY-----
I0613 19:02:35.792072    9007 grpc_attestor.go:1049]      ======= CreateKeyUsingAuthUnrestricted ========
I0613 19:02:35.797076    9007 grpc_attestor.go:1082]      PCR [0] Value d0c70a9310cd0b55767084333022ce53f42befbb69c059ee6c0a32766f160783 
I0613 19:02:35.798788    9007 grpc_attestor.go:1082]      PCR [7] Value 3d91599581f7a3a3a1bb7c7a55a7b8a50967be6506a5f47a9e89fef756fab07a 
I0613 19:02:35.940770    9007 grpc_attestor.go:1097]      Unrestricted ukPub: 0001000b00040072000000100014000b0800000000000100d330fc61a89ea4f5cee29582f1fdd1a30cdc7f6688a3e5337cbf4add52a3140f93cc950a6611fe1398fa010ba8d78863dae220373efcd79973391920b2303118b56bf9b389d2f0e199c076409d404b141eec552278a880b53a3a83867b9638011e7709be15a3bd79703f620827e0e0deb34729af3135d2ff33786e57eb2ce3203016f17bbf962ae65b1a36c9f8cc20c6a348cc83fb6e548982561c45c2d10a6dcd8a810e2e4e9afe6928b809185e9ea24ef465653003a9498f5d59a637ef5362b914672be99aee7cd52f3649fd4430bcc48178f471e1a2094e95770775573fcf1426e958f8fd23d37ed09517acd67ecd0514e20e2c3eb985079208253b424a5d,
I0613 19:02:35.940817    9007 grpc_attestor.go:1098]      Unrestricted ukPriv: 0020e5a9ee7ae3f492e0eb71518fe07132d26384ec9cff5e3b3826fd4ded32ae26820010595d58fdb2de5118d880bade5dbcf883f99659facd9e61d2a237040480fea91442ec1cddc55b865f4e712cf02d0df8a34b215f166f2a55bae78ff4e501be564cdadebc6600a2c4ed74b6ed79591268bdf9f46d4579158645b2aa6cfc5374e1ea64b0c1bde5a0938cc563348214beec1fd888bf1ad474de52a724e5a013f5b6d94dd58a357c4fad0c03edcf83ca656151a32338799e1f2c882d9fa386b91038a3e52779b31a4dbaedc50a7b3a1929db10303bf4781c6485bbded3,
I0613 19:02:35.940841    9007 grpc_attestor.go:1100]      Write (ukPub) ========
I0613 19:02:35.941040    9007 grpc_attestor.go:1106]      Write (ukPriv) ========
I0613 19:02:35.950452    9007 grpc_attestor.go:1143]      ukeyName: ACIAC+V2NRoBpYk0cHbQjU7AYgTbFBF2iazbJTRULoTd0Rdb,
I0613 19:02:35.950543    9007 grpc_attestor.go:1169]      uakPub PEM 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0zD8YaiepPXO4pWC8f3R
owzcf2aIo+UzfL9K3VKjFA+TzJUKZhH+E5j6AQuo14hj2uIgNz7815lzORkgsjAx
GLVr+bOJ0vDhmcB2QJ1ASxQe7FUieKiAtTo6g4Z7ljgBHncJvhWjvXlwP2IIJ+Dg
3rNHKa8xNdL/M3huV+ss4yAwFvF7v5Yq5lsaNsn4zCDGo0jMg/tuVImCVhxFwtEK
bc2KgQ4uTpr+aSi4CRhenqJO9GVlMAOpSY9dWaY371NiuRRnK+ma7nzVLzZJ/UQw
vMSBePRx4aIJTpV3B3VXP88UJulY+P0j037QlRes1n7NBRTiDiw+uYUHkgglO0JK
XQIDAQAB
-----END PUBLIC KEY-----
I0613 19:02:35.956004    9007 grpc_attestor.go:1179]      Certify Attestation: ff54434780170022000bb30aa3cf3c3aedf9c89175b859bcd7d031602f0e71691a40033a5a484363248d000000000000000b33430000000f000000000120160511001628000022000be576351a01a589347076d08d4ec06204db14117689acdb2534542e84ddd1175b0022000b8eb3da21cf42f67f9e5f42feb5b1a7a9aa1458a36cba6f8c00c2bb412b85457c,
I0613 19:02:35.956067    9007 grpc_attestor.go:1180]      Certify Signature: b659b6535fdb0a439798ecd5e582d6ea9051c657203a28f4a5088279403477d5e5b01ef1fae476cb26a42f8a5517a3587483f924cab7510a403ee497dd0d53c19bdae6b354421632c1961510ab316744671fb8d40edf0a79a977df906f113c6b76909c4316cef3bb2d2221a37bbd7acca4f411ef95d078d7d800be52a56ade4875971f136481de7b664ed73c84592712497f40318d35b68deb9c5c41c52dfd7c0e24a10b064633750fa258eb165e90923eab056176563c6a6419b69e7ad7f31340e2686bc4d59bd2c84a8cddb0ef1042fa3ab6662c9817a795ab1576ec65e9f3a077f40b1e179e86b23bce5925513db986c4aebce7647c81602c6ec5fb6177c3,
I0613 19:02:35.957478    9007 grpc_attestor.go:1185]      Data to sign: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I0613 19:02:35.965056    9007 grpc_attestor.go:1201]      Test Signature:  L4FZqzHHXUrd60NqMQqnZpCREwuOHZtt/ymPdJvJ12RjoKSIBjIHkXpLREJtfi/DPn2OOK4obXMeafBLIyaerggMekuFSTLJFFpNOImzNxCaAtV+vYEydD/+zgd/vb9UzmotouAt5OMouPo5/UYX8ytEc8fA1IouZV4qNHmTQgE2jQMY9rQoi7xq/FcuUrR+vIJPN0NwC+ip86T8vnscnxUDxjle0rjWYyW8n2hc2bn/Pw/vcRnM54q8qJquoEuJv21ElH841tVKKj5R0zROusHT2C+FOZ6KOvOJvbQR+fMPTOSP8hLenr1o2F6cnY8NQywsaio8/uCj/AR0JWFoDg
I0613 19:02:35.965117    9007 grpc_attestor.go:1204]      Read and Decode (attestion)
I0613 19:02:35.965209    9007 grpc_attestor.go:1244]      Attestation : MatchesPublic true
I0613 19:02:35.965243    9007 grpc_attestor.go:1245]      Attestation att.AttestedCertifyInfo.Name: 5XY1GgGliTRwdtCNTsBiBNsUEXaJrNslNFQuhN3RF1s=
I0613 19:02:35.965280    9007 grpc_attestor.go:1253]      Decoding PublicKey for AK ========
I0613 19:02:35.965453    9007 grpc_attestor.go:1282]      Signature Verified
I0613 19:02:35.965512    9007 grpc_attestor.go:1297]      Returning PullRSAKeyResponse

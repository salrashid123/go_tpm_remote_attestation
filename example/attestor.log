# go run src/grpc_attestor.go --grpcport :50051  --unsealPcrs=0,7 \
  --caCertTLS certs/CA_crt.pem  --servercert certs/attestor_crt.pem \
   --serverkey certs/attestor_key.pem   -useFullAttestation --readEventLog \
     --platformCertFile certs/platform_cert.der   --v=10 -alsologtostderr

I1031 15:40:13.576866   29079 grpc_attestor.go:1364] Starting gRPC server on port :50051
I1031 15:40:23.842205   29079 grpc_attestor.go:133] >> inbound request
I1031 15:40:23.842225   29079 grpc_attestor.go:156] HealthCheck called for Service [verifier.VerifierServer]
I1031 15:40:23.843646   29079 grpc_attestor.go:133] >> inbound request
I1031 15:40:23.843696   29079 grpc_attestor.go:170] ======= GetPlatformCert ========
I1031 15:40:23.843716   29079 grpc_attestor.go:171]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I1031 15:40:23.843801   29079 grpc_attestor.go:189]      Returning GetPlatformCert ========
I1031 15:40:23.844936   29079 grpc_attestor.go:133] >> inbound request
I1031 15:40:23.844989   29079 grpc_attestor.go:288] ======= GetEKCert ========
I1031 15:40:23.845005   29079 grpc_attestor.go:289]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I1031 15:40:23.845018   29079 grpc_attestor.go:295] =============== Load EncryptionKey and Certifcate from NV ===============
I1031 15:40:23.864609   29079 grpc_attestor.go:314]      Encryption PEM 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAy28Vyf1Gj9pa9Uw8fxfj
hAL/W9RaQz94zexmL9z93dJp0JvfYPYSsTQHNekMx7jsySf6gBMywE/ex/+OnX/Y
e1zs5621btskqsvTzhn5T/vjAVrKoYhGgCj9RS4gPpCVmwULowDxbtGUvVCUUU2g
Bv8YWGvaoQaYTz4Zi2+ZBSFiZIBiY2ESRrzEYyvkttoaRFJykwSyXcCLabkR+oVQ
ajKbB2gsw3ObFG10hUPGR5HvUN6ECSNhvk1HoYESvZinH8NzJHtmbyOfZsSfx7aI
dBxcg4U4ctDS8HNcJHGwQahlZpD1ba2lJpndWNi6IKNyHSAfgnjkbCj4V6iU9Rhk
DQIDAQAB
-----END PUBLIC KEY-----
I1031 15:40:23.882101   29079 grpc_attestor.go:343]      Encryption Issuer x509 tpm_ek_v1_cloud_host-signer-0-2021-10-12T04:22:11-07:00 K:1, 3:nbvaGZFLcuc:0:18
I1031 15:40:23.882137   29079 grpc_attestor.go:345]      Returning GetEKCert
I1031 15:40:23.889260   29079 grpc_attestor.go:133] >> inbound request
I1031 15:40:23.889287   29079 grpc_attestor.go:354] ======= GetAK ========
I1031 15:40:23.889293   29079 grpc_attestor.go:355]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I1031 15:40:23.890270   29079 grpc_attestor.go:363]      PCR [0] Value 24af52a4f429b71a3184a6d64cddad17e54ea030e2aa6576bf3a5a3d8bd3328f 
I1031 15:40:23.891134   29079 grpc_attestor.go:363]      PCR [7] Value 3d91599581f7a3a3a1bb7c7a55a7b8a50967be6506a5f47a9e89fef756fab07a 
I1031 15:40:23.891152   29079 grpc_attestor.go:369]      createPrimary
I1031 15:40:24.031145   29079 grpc_attestor.go:393]      tpmEkPub: 
&{25681154019117354631408477937382798842814401680247298435980403693868621298422727887981829456468864783183018759084912984787126597913309590274598696914016505044670776797875083392021842046064884557413107257319454211782505291980729655790356631874590859911826772599069602925555626283575516807416165151072982758032258805500245319054819438396185828821536129298876496239367106963072364642618013101985042854473298489695567983683855480825841475162834664060683938219136668868705403458809734029329911926620096096402417262823726386093541394003094647648853417728297065108346026448743640822982027859520557816973166641500169193415693 65537}
I1031 15:40:24.031351   29079 grpc_attestor.go:406]      ekPub Name: 000b709c615149d341fa074ca4d7e77dfc2bd8f2ca8d72b2a773f205600494a1436d
I1031 15:40:24.031371   29079 grpc_attestor.go:407]      ekPubPEM: 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAy28Vyf1Gj9pa9Uw8fxfj
hAL/W9RaQz94zexmL9z93dJp0JvfYPYSsTQHNekMx7jsySf6gBMywE/ex/+OnX/Y
e1zs5621btskqsvTzhn5T/vjAVrKoYhGgCj9RS4gPpCVmwULowDxbtGUvVCUUU2g
Bv8YWGvaoQaYTz4Zi2+ZBSFiZIBiY2ESRrzEYyvkttoaRFJykwSyXcCLabkR+oVQ
ajKbB2gsw3ObFG10hUPGR5HvUN6ECSNhvk1HoYESvZinH8NzJHtmbyOfZsSfx7aI
dBxcg4U4ctDS8HNcJHGwQahlZpD1ba2lJpndWNi6IKNyHSAfgnjkbCj4V6iU9Rhk
DQIDAQAB
-----END PUBLIC KEY-----
I1031 15:40:24.031402   29079 grpc_attestor.go:421]      CreateKeyUsingAuth
I1031 15:40:24.205379   29079 grpc_attestor.go:472]      ContextSave (ek)
I1031 15:40:24.216225   29079 grpc_attestor.go:485]      ContextLoad (ek)
I1031 15:40:24.225628   29079 grpc_attestor.go:498]      LoadUsingAuth
I1031 15:40:24.236025   29079 grpc_attestor.go:535]      AK keyName 0022000bdf1e08634db8af36d5c1508c69b0963d175ee07d5146a4de00be2aaf9898db8f
I1031 15:40:24.239735   29079 grpc_attestor.go:560]      akPubPEM: 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0Uc+mU5ARSpCgywedn4k
b8hezYeGVXVKDpImpPbet7dVyuIEv52SZs2ugUplXuKuQVWDGr5goHK7MIFvpAnW
D2Efm7t2tnm7mmkIH8tBUXfLlSWo6bmRq9TeyNh+RaVkPL1YfN3IjgwjRMRAq1kq
bMLtRE8KaAKc806xndIifnzIpkTZtR0PLxiqIA7dZZpBiOoATaU7NwXZMUy5VlwH
KnqqZ+7xGxMB6z2v+t1o7p6PtiqdoCLCqW1XamnwXLXonLmYA05fzko4ZXrMzQBG
9hNZOOBvDx8PVwZlinu4pSWQvDnBqHjCvOfkQhH9n9o6NgBlcEFRvVJ0tDfaFt02
MQIDAQAB
-----END PUBLIC KEY-----
I1031 15:40:24.239795   29079 grpc_attestor.go:562]      Write (akPub) ========
I1031 15:40:24.239927   29079 grpc_attestor.go:568]      Write (akPriv) ========
I1031 15:40:24.240008   29079 grpc_attestor.go:580]      Returning GetAK ========
I1031 15:40:24.258316   29079 grpc_attestor.go:133] >> inbound request
I1031 15:40:24.258354   29079 grpc_attestor.go:592] ======= ActivateCredential ========
I1031 15:40:24.258364   29079 grpc_attestor.go:593]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I1031 15:40:24.258371   29079 grpc_attestor.go:595]      ContextLoad (ek)
I1031 15:40:24.267617   29079 grpc_attestor.go:608]      Read (akPub)
I1031 15:40:24.267699   29079 grpc_attestor.go:614]      Read (akPriv)
I1031 15:40:24.277910   29079 grpc_attestor.go:656]      keyName 0022000bdf1e08634db8af36d5c1508c69b0963d175ee07d5146a4de00be2aaf9898db8f
I1031 15:40:24.277953   29079 grpc_attestor.go:658]      ActivateCredentialUsingAuth
I1031 15:40:24.287472   29079 grpc_attestor.go:711]      <--  activateCredential()
I1031 15:40:24.294402   29079 grpc_attestor.go:133] >> inbound request
I1031 15:40:24.294426   29079 grpc_attestor.go:197] ======= Attest ========
I1031 15:40:24.294433   29079 grpc_attestor.go:198]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I1031 15:40:24.294440   29079 grpc_attestor.go:205]      ContextLoad (ek) ========
I1031 15:40:24.303540   29079 grpc_attestor.go:217]      LoadUsingAuth ========
I1031 15:40:24.304932   29079 grpc_attestor.go:241]      Read (akPub) ========
I1031 15:40:24.305052   29079 grpc_attestor.go:247]      Read (akPriv) ========
I1031 15:40:24.309962   29079 grpc_attestor.go:261]      AK keyName 0022000bdf1e08634db8af36d5c1508c69b0963d175ee07d5146a4de00be2aaf9898db8f
I1031 15:40:24.313631   29079 grpc_attestor.go:268]      AK CachedKey Name df1e08634db8af36d5c1508c69b0963d175ee07d5146a4de00be2aaf9898db8f
I1031 15:40:24.365331   29079 grpc_attestor.go:280]      Returning Attest ========
I1031 15:40:24.384393   29079 grpc_attestor.go:133] >> inbound request
I1031 15:40:24.384419   29079 grpc_attestor.go:823] ======= PushSecret ========
I1031 15:40:24.384442   29079 grpc_attestor.go:824]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I1031 15:40:24.384458   29079 grpc_attestor.go:827]      Loading EndorsementKeyRSA
I1031 15:40:24.391108   29079 grpc_attestor.go:844]      Importing External Key
I1031 15:40:24.412123   29079 grpc_attestor.go:850]      <-- End importKey()
I1031 15:40:24.412161   29079 grpc_attestor.go:854]      Hash of imported Key bZeQ9G0KuKpHVwfZuobcMf7tL/ViU1maVaJCAY+QjfU=
I1031 15:40:24.416380   29079 grpc_attestor.go:133] >> inbound request
I1031 15:40:24.416405   29079 grpc_attestor.go:943] ======= PullRSAKey ========
I1031 15:40:24.416414   29079 grpc_attestor.go:944]      client provided uid: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I1031 15:40:24.416422   29079 grpc_attestor.go:946] ======= Generate UnrestrictedKey ========
I1031 15:40:24.416428   29079 grpc_attestor.go:948]      ContextLoad (ek) ========
I1031 15:40:24.426548   29079 grpc_attestor.go:961]      Loading AttestationKey
I1031 15:40:24.435052   29079 grpc_attestor.go:1002]      AK keyName: ACIAC98eCGNNuK821cFQjGmwlj0XXuB9UUak3gC+Kq+YmNuP,
I1031 15:40:24.436608   29079 grpc_attestor.go:1029]      akPub PEM 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0Uc+mU5ARSpCgywedn4k
b8hezYeGVXVKDpImpPbet7dVyuIEv52SZs2ugUplXuKuQVWDGr5goHK7MIFvpAnW
D2Efm7t2tnm7mmkIH8tBUXfLlSWo6bmRq9TeyNh+RaVkPL1YfN3IjgwjRMRAq1kq
bMLtRE8KaAKc806xndIifnzIpkTZtR0PLxiqIA7dZZpBiOoATaU7NwXZMUy5VlwH
KnqqZ+7xGxMB6z2v+t1o7p6PtiqdoCLCqW1XamnwXLXonLmYA05fzko4ZXrMzQBG
9hNZOOBvDx8PVwZlinu4pSWQvDnBqHjCvOfkQhH9n9o6NgBlcEFRvVJ0tDfaFt02
MQIDAQAB
-----END PUBLIC KEY-----
I1031 15:40:24.436640   29079 grpc_attestor.go:1033]      ======= CreateKeyUsingAuthUnrestricted ========
I1031 15:40:24.440159   29079 grpc_attestor.go:1066]      PCR [0] Value 24af52a4f429b71a3184a6d64cddad17e54ea030e2aa6576bf3a5a3d8bd3328f 
I1031 15:40:24.441983   29079 grpc_attestor.go:1066]      PCR [7] Value 3d91599581f7a3a3a1bb7c7a55a7b8a50967be6506a5f47a9e89fef756fab07a 
I1031 15:40:24.569034   29079 grpc_attestor.go:1084]      Write (ukPub) ========
I1031 15:40:24.569205   29079 grpc_attestor.go:1090]      Write (ukPriv) ========
I1031 15:40:24.578208   29079 grpc_attestor.go:1153]      uakPub PEM 
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAznugLbOT1nFrtEU+EKtB
nR+Dom5i+CiK72eCP/d5vq6Czy7YM2/NL080Zj+UhAYYoIOUlIIV4NKIUV8hInbD
t19RViONcZVPtV12owjucCZ60/xfztHcnryfrB0XcsCNRmQHOpKi+Z5UAgra1J9q
jVM+7lP3R+25gdjDz7Rtw8tr4ErIqhMY1hz3Ea6OXs251hkd/apTJ+zPrHqsfEXT
66mfehc98Xr4q5zrw7mGqcxR9QEr1zBNRCJCURFKQr5qS7WjcDjE7Yk3zgTomN9x
FakNG7EYWQkbMcf39P3SXuMdrPoVDwTQtneyo/pBZ2BOSgalnNiWaaHtTvTffW+a
QQIDAQAB
-----END PUBLIC KEY-----
I1031 15:40:24.585711   29079 grpc_attestor.go:1169]      Data to sign: 369c327d-ad1f-401c-aa91-d9b0e69bft67
I1031 15:40:24.592612   29079 grpc_attestor.go:1185]      Test Signature:  ZRkeuCLLD/NLKFyZY7OYOFC2OfVMi3b65LoSc+6neQfreE0FAtJHJhnU8zy6vObM9vwk/bcfhz5TkWw57CT3nNVFODAldTDyEvwPH8pF71zi1uMBSd7uiW8qHrg2XrCAtgYVJNUQEJiCX5CdsXnNyHiLauEKKXZnjfqqnGdjc5mOGSlDF4bPzXRXz4PkRcFjBOqb1P+rnNrqHCa2GM1mNBIzYhASS0zL5ByhHXQG91RYtXBAqaw9Nea6vKEHQRj4QU02vmxcuIG4vuWW0hrv36vRjWscciWvN+yVRlLzHPyd97jd8Msyq+ZOJ4qQS/W2MfBsnbigA5g/x0tSDUgKOw
I1031 15:40:24.592721   29079 grpc_attestor.go:1237]      Decoding PublicKey for AK ========
I1031 15:40:24.592853   29079 grpc_attestor.go:1266]      Signature Verified
I1031 15:40:24.592908   29079 grpc_attestor.go:1281]      Returning PullRSAKeyResponse
